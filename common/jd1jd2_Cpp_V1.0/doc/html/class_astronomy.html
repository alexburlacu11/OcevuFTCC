<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>jd1jd2: Astronomy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">jd1jd2
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Computes next time an object will be observable, and how long</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_astronomy.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_astronomy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Astronomy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b>Classes for astronomical calculations</b>  
 <a href="class_astronomy.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="astronomy_8h_source.html">astronomy.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_astronomy_1_1coord.html">coord</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure defining coordinates in sexigesimal format.  <a href="struct_astronomy_1_1coord.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a62366a714639b3e9b08fb5769246840c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62366a714639b3e9b08fb5769246840c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a62366a714639b3e9b08fb5769246840c">Astronomy</a> ()</td></tr>
<tr class="memdesc:a62366a714639b3e9b08fb5769246840c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor Gives default values to parameters. <br/></td></tr>
<tr class="separator:a62366a714639b3e9b08fb5769246840c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a5125e87a916d99912178698837ad1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a81a5125e87a916d99912178698837ad1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a81a5125e87a916d99912178698837ad1">~Astronomy</a> ()</td></tr>
<tr class="memdesc:a81a5125e87a916d99912178698837ad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br/></td></tr>
<tr class="separator:a81a5125e87a916d99912178698837ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc2c4a4f5d95dff7f1c1ed533c998cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#acbc2c4a4f5d95dff7f1c1ed533c998cb">horizCoord</a> (double dec, double ha, double lat, double *altitude, double *azimuth, double *parangle)</td></tr>
<tr class="memdesc:acbc2c4a4f5d95dff7f1c1ed533c998cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes horizontal coordinates, altitude and azimuth,.  <a href="#acbc2c4a4f5d95dff7f1c1ed533c998cb">More...</a><br/></td></tr>
<tr class="separator:acbc2c4a4f5d95dff7f1c1ed533c998cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa40f7e714fd7972d380aef12a8fb8a53"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aa40f7e714fd7972d380aef12a8fb8a53">secant_z</a> (double alt)</td></tr>
<tr class="memdesc:aa40f7e714fd7972d380aef12a8fb8a53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the secant of z,.  <a href="#aa40f7e714fd7972d380aef12a8fb8a53">More...</a><br/></td></tr>
<tr class="separator:aa40f7e714fd7972d380aef12a8fb8a53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70f57ef9abe20b209610e088485c409a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a70f57ef9abe20b209610e088485c409a">true_airmass</a> (double secz)</td></tr>
<tr class="memdesc:a70f57ef9abe20b209610e088485c409a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the true airmass for a given secant z.  <a href="#a70f57ef9abe20b209610e088485c409a">More...</a><br/></td></tr>
<tr class="separator:a70f57ef9abe20b209610e088485c409a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cafafeccaf1320085aeb2f8b555a8b8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a6cafafeccaf1320085aeb2f8b555a8b8">ha_alt</a> (double dec, double lat, double alt)</td></tr>
<tr class="memdesc:a6cafafeccaf1320085aeb2f8b555a8b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns hour angle at which object at dec is at altitude alt.  <a href="#a6cafafeccaf1320085aeb2f8b555a8b8">More...</a><br/></td></tr>
<tr class="separator:a6cafafeccaf1320085aeb2f8b555a8b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace5e9538970edf56c5c3f0787f0b5278"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace5e9538970edf56c5c3f0787f0b5278"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#ace5e9538970edf56c5c3f0787f0b5278">atan_circ</a> (double x, double y)</td></tr>
<tr class="memdesc:ace5e9538970edf56c5c3f0787f0b5278"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns radian angle 0 to 2pi for coords x, y &ndash; get that quadrant right !! <br/></td></tr>
<tr class="separator:ace5e9538970edf56c5c3f0787f0b5278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59aaa2bb41565091dc4a0fa1df03af72"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59aaa2bb41565091dc4a0fa1df03af72"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a59aaa2bb41565091dc4a0fa1df03af72">min_max_alt</a> (double lat, double decc, double *min_alt, double *max_alt)</td></tr>
<tr class="memdesc:a59aaa2bb41565091dc4a0fa1df03af72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes minimum and maximum altitude for a given dec and latitude. <br/></td></tr>
<tr class="separator:a59aaa2bb41565091dc4a0fa1df03af72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec809bd98d61dc0039e8794ffe55f7e5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aec809bd98d61dc0039e8794ffe55f7e5">subtend</a> (double ra1, double dec1, double ra2, double dec2)</td></tr>
<tr class="memdesc:aec809bd98d61dc0039e8794ffe55f7e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Angle subtended by two positions in the sky &ndash;.  <a href="#aec809bd98d61dc0039e8794ffe55f7e5">More...</a><br/></td></tr>
<tr class="separator:aec809bd98d61dc0039e8794ffe55f7e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3266f3771c39969b737e58d90d37593c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a3266f3771c39969b737e58d90d37593c">lst</a> (double jd, double longitude)</td></tr>
<tr class="memdesc:a3266f3771c39969b737e58d90d37593c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the local MEAN sidereal time (dec hrs)  <a href="#a3266f3771c39969b737e58d90d37593c">More...</a><br/></td></tr>
<tr class="separator:a3266f3771c39969b737e58d90d37593c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130ccda25a57a6aa98834daca603d474"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a130ccda25a57a6aa98834daca603d474"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a130ccda25a57a6aa98834daca603d474">bab_to_dec</a> (<a class="el" href="struct_astronomy_1_1coord.html">coord</a> bab)</td></tr>
<tr class="memdesc:a130ccda25a57a6aa98834daca603d474"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a "babylonian" (sexigesimal) structure into double-precision floating point ("decimal") number. <br/></td></tr>
<tr class="separator:a130ccda25a57a6aa98834daca603d474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af589aaee13587e1c081142ae3d0094ed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af589aaee13587e1c081142ae3d0094ed"></a>
<a class="el" href="struct_astronomy_1_1coord.html">coord</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#af589aaee13587e1c081142ae3d0094ed">dec_to_bab</a> (double deci)</td></tr>
<tr class="memdesc:af589aaee13587e1c081142ae3d0094ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for converting decimal to babylonian hh mm ss.ss. <br/></td></tr>
<tr class="separator:af589aaee13587e1c081142ae3d0094ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae429e427a23bf900087bbbe36e91b3a"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aae429e427a23bf900087bbbe36e91b3a">print_time</a> (<a class="el" href="struct_astronomy_1_1coord.html">coord</a> tme, int UT, int secPrec)</td></tr>
<tr class="memdesc:aae429e427a23bf900087bbbe36e91b3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build a string with coordinate or time in sexigesimal units.  <a href="#aae429e427a23bf900087bbbe36e91b3a">More...</a><br/></td></tr>
<tr class="separator:aae429e427a23bf900087bbbe36e91b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef8e948a098f5ab5b6f8a2fed84b4ecf"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aef8e948a098f5ab5b6f8a2fed84b4ecf">print_time</a> (double t, int UT, int secPrec)</td></tr>
<tr class="memdesc:aef8e948a098f5ab5b6f8a2fed84b4ecf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an overloaded member function, provided for convenience.  <a href="#aef8e948a098f5ab5b6f8a2fed84b4ecf">More...</a><br/></td></tr>
<tr class="separator:aef8e948a098f5ab5b6f8a2fed84b4ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d9c4204f75221388de8ff5ab3640c4e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a2d9c4204f75221388de8ff5ab3640c4e">adj_time</a> (double x)</td></tr>
<tr class="memdesc:a2d9c4204f75221388de8ff5ab3640c4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjusts a time (decimal hours) to be between -12 and 12,.  <a href="#a2d9c4204f75221388de8ff5ab3640c4e">More...</a><br/></td></tr>
<tr class="separator:a2d9c4204f75221388de8ff5ab3640c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab567bdcf3f5d0175ba5d2eed40a5f7aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab567bdcf3f5d0175ba5d2eed40a5f7aa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#ab567bdcf3f5d0175ba5d2eed40a5f7aa">eclrot</a> (double jd, double *x, double *y, double *z)</td></tr>
<tr class="memdesc:ab567bdcf3f5d0175ba5d2eed40a5f7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotates ecliptic rectangular coords x, y, z to equatorial (all assumed of date.) <br/></td></tr>
<tr class="separator:ab567bdcf3f5d0175ba5d2eed40a5f7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141c56c4a2533f65ff495a152997d25c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a141c56c4a2533f65ff495a152997d25c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a141c56c4a2533f65ff495a152997d25c">circulo</a> (double x)</td></tr>
<tr class="memdesc:a141c56c4a2533f65ff495a152997d25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assuming x is an angle in degrees, returns modulo 360 degrees. <br/></td></tr>
<tr class="separator:a141c56c4a2533f65ff495a152997d25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae9aacaca91938a2f0f6e6a2b4b13a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a6ae9aacaca91938a2f0f6e6a2b4b13a9">geocent</a> (double geolong, double geolat, double height, double *x_geo, double *y_geo, double *z_geo)</td></tr>
<tr class="memdesc:a6ae9aacaca91938a2f0f6e6a2b4b13a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the geocentric coordinates from the geodetic.  <a href="#a6ae9aacaca91938a2f0f6e6a2b4b13a9">More...</a><br/></td></tr>
<tr class="separator:a6ae9aacaca91938a2f0f6e6a2b4b13a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6cc3c740a1b01fa7052929a19fc093"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#afe6cc3c740a1b01fa7052929a19fc093">etcorr</a> (double jd)</td></tr>
<tr class="memdesc:afe6cc3c740a1b01fa7052929a19fc093"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a julian date in 1900-2100, returns the correction delta t<br/>
 TDT - UT (after 1983 and before 1998)<br/>
 ET - UT (before 1983)<br/>
 an extrapolated guess (after 2005).  <a href="#afe6cc3c740a1b01fa7052929a19fc093">More...</a><br/></td></tr>
<tr class="separator:afe6cc3c740a1b01fa7052929a19fc093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3005e80e642a50974c7aa06fc7b441b4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a3005e80e642a50974c7aa06fc7b441b4">ztwilight</a> (double alt)</td></tr>
<tr class="memdesc:a3005e80e642a50974c7aa06fc7b441b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">evaluates a polynomial expansion for the approximate brightening of the zenith in twilight  <a href="#a3005e80e642a50974c7aa06fc7b441b4">More...</a><br/></td></tr>
<tr class="separator:a3005e80e642a50974c7aa06fc7b441b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b4524c949894871e56d4b092d02244"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aa5b4524c949894871e56d4b092d02244">xyz_cel</a> (double x, double y, double z, double *ra, double *dec)</td></tr>
<tr class="memdesc:aa5b4524c949894871e56d4b092d02244"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts cartesian coordinate (x,y,z) to right ascension and declination,.  <a href="#aa5b4524c949894871e56d4b092d02244">More...</a><br/></td></tr>
<tr class="separator:aa5b4524c949894871e56d4b092d02244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bdf58295faad385013fbacb73c472a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a0bdf58295faad385013fbacb73c472a2">aberrate</a> (double epoch, double vec[3], int from_std)</td></tr>
<tr class="memdesc:a0bdf58295faad385013fbacb73c472a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corrects celestial unit vector for aberration due to earth's motion.  <a href="#a0bdf58295faad385013fbacb73c472a2">More...</a><br/></td></tr>
<tr class="separator:a0bdf58295faad385013fbacb73c472a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d56400d71ede859ea9866ceef4863a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a7d56400d71ede859ea9866ceef4863a2">nutation_params</a> (double date_epoch, double *del_psi, double *del_ep)</td></tr>
<tr class="memdesc:a7d56400d71ede859ea9866ceef4863a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the nutation parameters delta psi and delta epsilon.  <a href="#a7d56400d71ede859ea9866ceef4863a2">More...</a><br/></td></tr>
<tr class="separator:a7d56400d71ede859ea9866ceef4863a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb0f764e8a505139d0ad8750691b2153"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aeb0f764e8a505139d0ad8750691b2153">precess</a> (double rin, double din, double std_epoch, double date_epoch, double *rout, double *dout, int just_precess, int from_std)</td></tr>
<tr class="memdesc:aeb0f764e8a505139d0ad8750691b2153"><td class="mdescLeft">&#160;</td><td class="mdescRight">General routine for precession and apparent place.  <a href="#aeb0f764e8a505139d0ad8750691b2153">More...</a><br/></td></tr>
<tr class="separator:aeb0f764e8a505139d0ad8750691b2153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac134844889e8ff7bb3fda22f831e1a3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#ac134844889e8ff7bb3fda22f831e1a3e">refract_corr</a> (double *ha, double *dec, double latitude, double *size, int sense)</td></tr>
<tr class="memdesc:ac134844889e8ff7bb3fda22f831e1a3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corrects local equatorial coordinates for refraction.  <a href="#ac134844889e8ff7bb3fda22f831e1a3e">More...</a><br/></td></tr>
<tr class="separator:ac134844889e8ff7bb3fda22f831e1a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73b80e20cb6a9d5b9e0ce4d85518a8e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aa73b80e20cb6a9d5b9e0ce4d85518a8e">refract_size</a> (double alt, double elev)</td></tr>
<tr class="memdesc:aa73b80e20cb6a9d5b9e0ce4d85518a8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes refraction size for a given altitude.  <a href="#aa73b80e20cb6a9d5b9e0ce4d85518a8e">More...</a><br/></td></tr>
<tr class="separator:aa73b80e20cb6a9d5b9e0ce4d85518a8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff446ad0e349bd9912d9a65742cd4bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#aeff446ad0e349bd9912d9a65742cd4bf">near_hor_refr</a> (double app_alt, double pressure)</td></tr>
<tr class="memdesc:aeff446ad0e349bd9912d9a65742cd4bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes near horizon refraction.  <a href="#aeff446ad0e349bd9912d9a65742cd4bf">More...</a><br/></td></tr>
<tr class="separator:aeff446ad0e349bd9912d9a65742cd4bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36524559d3ba9bfead5c6b0a8edc8f68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a36524559d3ba9bfead5c6b0a8edc8f68">galact</a> (double ra, double dec, double epoch, double *glong, double *glat)</td></tr>
<tr class="memdesc:a36524559d3ba9bfead5c6b0a8edc8f68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Algorithm for 3-d Euler rotation into galactic.  <a href="#a36524559d3ba9bfead5c6b0a8edc8f68">More...</a><br/></td></tr>
<tr class="separator:a36524559d3ba9bfead5c6b0a8edc8f68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad132dee2b16c6b76638f5173cbb8cb34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#ad132dee2b16c6b76638f5173cbb8cb34">eclipt</a> (double ra, double dec, double epoch, double jd, double *curep, double *eclong, double *eclat)</td></tr>
<tr class="memdesc:ad132dee2b16c6b76638f5173cbb8cb34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts ra and dec to ecliptic coords.  <a href="#ad132dee2b16c6b76638f5173cbb8cb34">More...</a><br/></td></tr>
<tr class="separator:ad132dee2b16c6b76638f5173cbb8cb34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a749844378c3f3ec5500ead278714652b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a749844378c3f3ec5500ead278714652b">barycor</a> (double jd, double *x, double *y, double *z, double *xdot, double *ydot, double *zdot)</td></tr>
<tr class="memdesc:a749844378c3f3ec5500ead278714652b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corrects heliocentric position and velocity to the solar system barycenter.  <a href="#a749844378c3f3ec5500ead278714652b">More...</a><br/></td></tr>
<tr class="separator:a749844378c3f3ec5500ead278714652b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015931eeff31f25b8df6b9abb41e9364"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a015931eeff31f25b8df6b9abb41e9364">helcor</a> (double jd, double ra, double dec, double ha, double lat, double elevsea, double *tcor, double *vcor)</td></tr>
<tr class="memdesc:a015931eeff31f25b8df6b9abb41e9364"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes heliocentric correction for time and velocity.  <a href="#a015931eeff31f25b8df6b9abb41e9364">More...</a><br/></td></tr>
<tr class="separator:a015931eeff31f25b8df6b9abb41e9364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a710c0b364fa35a9446dd78d6520cff4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_astronomy.html#a710c0b364fa35a9446dd78d6520cff4d">lsrcor</a> (double ra, double dec, double epoch, double *vcor)</td></tr>
<tr class="memdesc:a710c0b364fa35a9446dd78d6520cff4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the correction from bary/helio centric to local standard of rest.  <a href="#a710c0b364fa35a9446dd78d6520cff4d">More...</a><br/></td></tr>
<tr class="separator:a710c0b364fa35a9446dd78d6520cff4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b>Classes for astronomical calculations</b> </p>
<p>Adapted from c program skycalc by John Thorstensen, Dartmouth College. 'skycalc version: 6.1, 2005). JFLB 2014/04 </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a0bdf58295faad385013fbacb73c472a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::aberrate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vec</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>from_std</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Corrects celestial unit vector for aberration due to earth's motion. </p>
<p>Uses accurate sun position ... replace with crude one for more speed if needed.<br/>
 epoch, decimal year ...<br/>
 vec[]; celestial unit vector ...<br/>
 from_std; 1 = apply aberration, -1 = take aberration out.<br/>
 </p>

</div>
</div>
<a class="anchor" id="a2d9c4204f75221388de8ff5ab3640c4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::adj_time </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjusts a time (decimal hours) to be between -12 and 12,. </p>
<p>generally used for hour angles. </p>

</div>
</div>
<a class="anchor" id="a749844378c3f3ec5500ead278714652b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::barycor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>xdot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ydot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>zdot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Corrects heliocentric position and velocity to the solar system barycenter. </p>
<p>This routine takes the position x,y,z and velocity xdot,ydot,zdot, assumed heliocentric, and corrects them to the solar system barycenter taking into account the nine major planets. Routine evolved by inserting planetary data (given above) into an earlier, very crude barycentric correction. </p>

</div>
</div>
<a class="anchor" id="ad132dee2b16c6b76638f5173cbb8cb34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::eclipt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>curep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eclong</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eclat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts ra and dec to ecliptic coords. </p>
<p>precesses to current epoch first (and hands current epoch back for printing.) ra in decimal hrs, other coords in dec. deg. </p>

</div>
</div>
<a class="anchor" id="afe6cc3c740a1b01fa7052929a19fc093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::etcorr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a julian date in 1900-2100, returns the correction delta t<br/>
 TDT - UT (after 1983 and before 1998)<br/>
 ET - UT (before 1983)<br/>
 an extrapolated guess (after 2005). </p>
<p>For dates in the past (&lt;= 2001 and after 1900) the value is linearly interpolated on 5-year intervals; for dates after the present, an extrapolation is used, because the true value of delta t cannot be predicted precisely. Note that TDT is essentially the modern version of ephemeris time with a slightly cleaner definition.</p>
<p>Where the algorithm shifts there will be a small (&lt; 0.1 sec) discontinuity. Also, the 5-year linear interpolation scheme can lead to errors as large as 0.5 seconds in some cases, though usually rather smaller. One seldom has actual UT to work with anyway, since the commonly-used UTC is tied to TAI within an integer number of seconds. </p>

</div>
</div>
<a class="anchor" id="a36524559d3ba9bfead5c6b0a8edc8f68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::galact </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>glong</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>glat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Algorithm for 3-d Euler rotation into galactic. </p>
<p>Perfectly rigorous, and with reasonably accurate input numbers derived from original IAU definition of galactic pole (12 49, +27.4, 1950) and zero of long (at PA 123 deg from pole.) </p>

</div>
</div>
<a class="anchor" id="a6ae9aacaca91938a2f0f6e6a2b4b13a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::geocent </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>geolong</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>geolat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x_geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y_geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>z_geo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the geocentric coordinates from the geodetic. </p>
<p>(standard map-type) longitude, latitude, and height. These are assumed to be in decimal hours, decimal degrees, and meters respectively. Notation generally follows 1992 Astr Almanac, p. K11. </p>

</div>
</div>
<a class="anchor" id="a6cafafeccaf1320085aeb2f8b555a8b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::ha_alt </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns hour angle at which object at dec is at altitude alt. </p>
<p>If object is never at this altitude, signals with special return values 1000 (always higher) and -1000 (always lower). </p>

</div>
</div>
<a class="anchor" id="a015931eeff31f25b8df6b9abb41e9364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::helcor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>elevsea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tcor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vcor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes heliocentric correction for time and velocity. </p>
<p>Finds heliocentric correction for given jd, ra, dec, ha, and lat. tcor is time correction in seconds, vcor velocity in km/s, to be added to the observed values. Input ra and dec assumed to be at current epoch. </p>

</div>
</div>
<a class="anchor" id="acbc2c4a4f5d95dff7f1c1ed533c998cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::horizCoord </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>altitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>azimuth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>parangle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes horizontal coordinates, altitude and azimuth,. </p>
<p>for declination, hour angle and observatory latitude (decimal degr, hr, degr). Also computes parallactic angle (decimal degr) </p>

</div>
</div>
<a class="anchor" id="a710c0b364fa35a9446dd78d6520cff4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::lsrcor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vcor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the correction from bary/helio centric to local standard of rest. </p>
<p>i.e. (v wrt lsr) = (v helio) + vcor.<br/>
 velocity of the sun is taken to be 13 km/s toward 1900 coords 18 0 0 +30 0 0 </p>

</div>
</div>
<a class="anchor" id="a3266f3771c39969b737e58d90d37593c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::lst </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>longitude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the local MEAN sidereal time (dec hrs) </p>
<p>at julian date jd at west longitude long (decimal hours). Follows definitions in 1992 Astronomical Almanac, pp. B7 and L2. Expression for GMST at 0h ut referenced to Aoki et al, A&amp;A 105, p.359, 1982. On workstations, accuracy (numerical only!) is about a millisecond in the 1990s. </p>

</div>
</div>
<a class="anchor" id="aeff446ad0e349bd9912d9a65742cd4bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::near_hor_refr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>app_alt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes near horizon refraction. </p>
<p>formula for near horizon, function-ized for iteration ... Almanac 1992, p. B62 &ndash; ignores temperature variation </p>

</div>
</div>
<a class="anchor" id="a7d56400d71ede859ea9866ceef4863a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::nutation_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>date_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>del_psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>del_ep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the nutation parameters delta psi and delta epsilon. </p>
<p>at julian epoch (in years) using approximate formulae given by Jean Meeus, Astronomical Formulae for Calculators, Willman-Bell, 1985, pp. 69-70. Accuracy appears to be a few hundredths of an arcsec or better and numerics have been checked against his example. Nutation parameters are returned in radians. </p>

</div>
</div>
<a class="anchor" id="aeb0f764e8a505139d0ad8750691b2153"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::precess </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>din</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>std_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>date_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>just_precess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>from_std</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>General routine for precession and apparent place. </p>
<p>Either transforms from current epoch (given by jd) to a standard epoch or back again, depending on value of the switch "from_std":<br/>
 1 transforms from standard to current,<br/>
 -1 goes the other way.<br/>
 Optionally does apparent place including nutation and annual aberration (but neglecting diurnal aberration,parallax, proper motion, and GR deflection of light); switch for this is "just_precess",<br/>
 1 does only precession,<br/>
 0 includes other aberration &amp; nutation.<br/>
 Precession uses a matrix procedures as outlined in Taff's Computational Spherical <a class="el" href="class_astronomy.html" title="Classes for astronomical calculations">Astronomy</a> book. This is the so-called 'rigorous' method which should give very accurate answers all over the sky over an interval of several centuries. Naked eye accuracy holds to ancient times, too. Precession constants used are the new IAU1976 &ndash; the 'J2000' system. Nutation is incorporated into matrix formalism by constructing an approximate nutation matrix and taking a matrix product with precession matrix. Aberration is done by adding the vector velocity of the earth to the velocity of the light ray, not kosher relativistically, but empirically correct to a high order for the angle.<br/>
 rin, din; input ra and dec<br/>
 rout, dout; output<br/>
 </p>

</div>
</div>
<a class="anchor" id="aae429e427a23bf900087bbbe36e91b3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Astronomy::print_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_astronomy_1_1coord.html">coord</a>&#160;</td>
          <td class="paramname"><em>tme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>secPrec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build a string with coordinate or time in sexigesimal units. </p>
<p>Add a statement of whether time is "local" (UT=0) or "ut" (UT=1) Any other value to add nothing. </p>

</div>
</div>
<a class="anchor" id="aef8e948a098f5ab5b6f8a2fed84b4ecf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Astronomy::print_time </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>UT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>secPrec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is an overloaded member function, provided for convenience. </p>
<p>The same with input time/coordinate given in decimal unit: </p>

</div>
</div>
<a class="anchor" id="ac134844889e8ff7bb3fda22f831e1a3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::refract_corr </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>latitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sense</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Corrects local equatorial coordinates for refraction. </p>
<p>if sense == 1 , applies refraction to a true ha and dec;<br/>
 if sense == -1, de-corrects already refracted coordinates.<br/>
 The calculation is done by computing xyz coordinates in the horizon system, adding to the vertical component, renormalizing back to a unit vector, rotating to the polar system, and transforming back to ha and dec .... a long way around the barn, but completely general. </p>

</div>
</div>
<a class="anchor" id="aa73b80e20cb6a9d5b9e0ce4d85518a8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::refract_size </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>elev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes refraction size for a given altitude. </p>
<p>Almanac for 1992, p. B 62. Ignores variation in temperature and just assumes T = 20 celsius.<br/>
 alt; altitude in degrees<br/>
 elev; elevation in meters<br/>
 </p>

</div>
</div>
<a class="anchor" id="aa40f7e714fd7972d380aef12a8fb8a53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::secant_z </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the secant of z,. </p>
<p>assuming the object is not too low to the horizon; returns 100. if the object is low but above the horizon, -100. if the object is just below the horizon. </p>

</div>
</div>
<a class="anchor" id="aec809bd98d61dc0039e8794ffe55f7e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::subtend </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Angle subtended by two positions in the sky &ndash;. </p>
<p>Return value is in radians. Hybrid algorithm works down to zero separation except very near the poles. </p>

</div>
</div>
<a class="anchor" id="a70f57ef9abe20b209610e088485c409a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Astronomy::true_airmass </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>secz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the true airmass for a given secant z. </p>
<p>The expression used is based on a tabulation of the mean KPNO atmosphere given by C. M. Snell &amp; A. M. Heiser, 1968, PASP, 80, 336. They tabulated the airmass at 5 degr intervals from z = 60 to 85 degrees; John Thorstensen fitted the data with a fourth order poly for (secz - airmass) as a function of (secz - 1) using the IRAF curfit routine, then adjusted the zeroth order term to force (secz - airmass) to zero at z = 0. The poly fit is very close to the tabulated points (largest difference is 3.2e-4) and appears smooth. This 85-degree point is at secz = 11.47, so for secz &gt; 12 it just return secz - 1.5 ... about the largest offset properly determined. </p>

</div>
</div>
<a class="anchor" id="aa5b4524c949894871e56d4b092d02244"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Astronomy::xyz_cel </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts cartesian coordinate (x,y,z) to right ascension and declination,. </p>
<p>returned in decimal hours and decimal degrees. </p>

</div>
</div>
<a class="anchor" id="a3005e80e642a50974c7aa06fc7b441b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float Astronomy::ztwilight </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>evaluates a polynomial expansion for the approximate brightening of the zenith in twilight </p>
<p>(in magnitudes) compared to its value at full night, as function of altitude of the sun (in degrees). To get this expression the author looked in Meinel, A., &amp; Meinel, M., "Sunsets, Twilight, &amp; Evening Skies", Cambridge U. Press, 1983; there's a graph on p. 38 showing the decline of zenith twilight. The author read points off this graph and fit them with a polynomial; the author don't even know what band there data are for! Comparison with Ashburn, E. V. 1952, JGR, v.57, p.85 shows that this is a good fit to his B-band measurements. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/jean-francois/instruments/GFT/JD1JD2/jd1jd2_Cpp/<a class="el" href="astronomy_8h_source.html">astronomy.h</a></li>
<li>/home/jean-francois/instruments/GFT/JD1JD2/jd1jd2_Cpp/astronomy.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_astronomy.html">Astronomy</a></li>
    <li class="footer">Generated on Wed Jun 4 2014 15:33:07 for jd1jd2 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
